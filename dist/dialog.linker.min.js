window.jQuery=window.jQuery||window.shoestring,function(a,b){a.componentNamespace=a.componentNamespace||a;var c,d,e="dialog",f=a.document,g=f.documentElement,h=f.body,i=b(g),j=a.componentNamespace.Dialog=function(d){return this.$el=b(d),this.$el.data(e)?this.$el.data(e):(this.$el.data(e,this),this.$background=this.$el.is("[data-"+e+"-nobg]")?b([]):b(f.createElement("div")).addClass(c.bkgd).attr("tabindex","-1").appendTo("body"),this.initialLocationHash=a.location.hash,this.nohistory="false"===this.$el.attr("data-dialog-history")||!j.history,this.hash=this.$el.attr("id")+"-dialog",this.hash+=this.nohistory?"-"+(new Date).getTime().toString():"",this.isOpen=!1,this.isTransparentBackground=this.$el.is("[data-transbg]"),void this._addA11yAttrs())};j.history=!0,j.useHash=!0,j.events=d={open:e+"-open",opened:e+"-opened",close:e+"-close",closed:e+"-closed",resize:e+"-resize"},j.classes=c={open:e+"-open",opened:e+"-opened",content:e+"-content",close:e+"-close",closed:e+"-closed",bkgd:e+"-background",bkgdOpen:e+"-background-open",bkgdTrans:e+"-background-trans"},j.selectors={close:"."+j.classes.close+", [data-close], [data-dialog-close]"},j.prototype.destroy=function(){window.focusRegistry.unregister(this),this.$el.trigger("destroy"),this.$el.data()[e]=void 0,this.$background.remove()},j.prototype.checkFocus=function(a){var c,d=b(a.target);return c=this.isOpen&&!d.closest(this.$el[0]).length&&this.isLastDialog()&&!this._isNonInteractive()},j.prototype.stealFocus=function(){this.$el[0].focus()},j.prototype._addA11yAttrs=function(){this.$el.attr("role","dialog").attr("tabindex","-1").find(j.selectors.close).attr("role","button")},j.prototype._removeA11yAttrs=function(){this.$el.removeAttr("role"),this.$el.removeAttr("tabindex")},j.prototype._isNonInteractive=function(){var a,b=window.getComputedStyle(this.$el[0],null),c=this.$el.find(j.selectors.close)[0];c&&(a=window.getComputedStyle(c,null));var d=window.getComputedStyle(this.$background[0],null);return"none"!==b.getPropertyValue("display")&&"hidden"!==b.getPropertyValue("visibility")&&(!a||"none"===a.getPropertyValue("display"))&&"none"===d.getPropertyValue("display")},j.prototype._checkInteractivity=function(){this._isNonInteractive()?(this._removeA11yAttrs(),this._ariaShowUnrelatedElems()):this._addA11yAttrs()},j.prototype._ariaHideUnrelatedElems=function(){this._ariaShowUnrelatedElems();var a="script, style",c=this.$el.siblings().not(a);this.$el.parents().not("body, html").each(function(){c=c.add(b(this).siblings().not(a))}),c.each(function(){var a=b(this).attr("aria-hidden")||"";b(this).attr("data-dialog-aria-hidden",a).attr("aria-hidden","true")})},j.prototype._ariaShowUnrelatedElems=function(){b("[data-dialog-aria-hidden]").each(function(){b(this).attr("data-dialog-aria-hidden").match("true|false")?b(this).attr("aria-hidden",b(this).attr("data-dialog-aria-hidden")):b(this).removeAttr("aria-hidden")}).removeAttr("data-dialog-aria-hidden")},j.prototype.resizeBackground=function(){if(this.$background.length){var a=(this.scroll||0)+this.$el[0].clientHeight;this.$background[0].style.height=Math.max(a,g.scrollHeight,g.clientHeight)+"px"}},j.prototype.open=function(){if(!this.isOpen){var b=this;this.$el.addClass(c.open),this.$background.addClass(c.bkgdOpen),this.$background.attr("id",this.$el.attr("id")+"-background"),this._setBackgroundTransparency(),this.scroll="pageYOffset"in a?a.pageYOffset:g.scrollY||g.scrollTop||h&&h.scrollY||0,this.$el[0].style.top=this.scroll+"px",this.resizeBackground(),i.addClass(c.open),this.isOpen=!0;var e=a.location.hash.replace(/^#/,"");a.Dialog.useHash&&(e.indexOf("-dialog")>-1&&!this.isLastDialog()?a.location.hash+="#"+this.hash:this.isLastDialog()||(a.location.hash=this.hash)),f.activeElement&&(this.focused=f.activeElement),this.$el[0].focus(),setTimeout(function(){b._ariaHideUnrelatedElems()}),this.$el.on(d.resize,function(){b.resizeBackground()}),this.$el.trigger(d.opened)}},j.prototype.lastHash=function(){return a.location.hash.split("#").pop()},j.prototype.isLastDialog=function(){return this.lastHash()===this.hash},j.prototype._setBackgroundTransparency=function(){this.isTransparentBackground&&this.$background.addClass(c.bkgdTrans)},j.prototype.close=function(){if(this.isOpen)if(this._ariaShowUnrelatedElems(),window.location.hash.split("#").pop()!==this.hash)this.$el.removeClass(c.open),this.$background.removeClass(c.bkgdOpen),this.isOpen=!1,this.focused&&!this.isLastDialog()&&this.focused.focus(),0===b("."+e+"."+c.open).length&&(i.removeClass(c.open),a.scrollTo(0,this.scroll)),this.$el.off(d.resize),this.$el.trigger(d.closed);else{var f=window.location.hash.split("#"),g=this.initialLocationHash.split("#");if(window.Dialog.useHash)if(f.join("")!==g.join(""))window.history.back();else{var h=this.hash.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");window.location.hash=window.location.hash.replace(new RegExp("#"+h+"$"),"")}}}}(this,window.jQuery),function(a,b){b(a.document).bind("click",function(c){function d(c){function d(){n.trigger("dialog-open")}var f,h=e.attr("href"),i=e.attr("data-dialog-addclass")||"",j=e.attr("data-dialog-labeledby")||"",k=e.attr("data-dialog-label")||"",l="false"===e.attr("data-dialog-history")||!a.componentNamespace.Dialog.history;h&&(f=encodeURIComponent(h));var m=b("[id='"+f+"']");if(m.length)return void m.html("").append(c).dialog().trigger("enhance").trigger("dialog-update");e.attr("href","#"+f).removeAttr("data-dialog-link");var n=b("<div class='dialog "+i+"' id='"+f+"' "+(l?" data-dialog-history='false'":"")+(k?" aria-label='"+k+"'":"")+(j?" aria-labelledby='"+j+"'":"")+"></div>").append(c).appendTo("body").dialog(),o=n.data("dialog");o&&!o.focused&&(o.focused=e[0]),g?n.find("iframe").one("load",d):d(),n.trigger("enhance")}var e=b(c.target).closest("a"),f=e.is("[data-dialog-link]"),g=e.is("[data-dialog-iframe]");if(f){var h=e.attr("href");e.is("[data-dialog-iframe]")?d("<iframe src='"+h+"' class='dialog-iframe'></iframe>"):b.get(h,d),c.preventDefault()}}),b(a).bind("hashchange load",function(){var c=a.location.hash.split("#").pop(),d=c.replace(/-dialog$/,""),e=b('a[href="'+decodeURIComponent(d)+'"][data-dialog-link], a[href="'+d+'"][data-dialog-link]'),f="false"===e.attr("data-dialog-history")||!a.componentNamespace.Dialog.history,g=b('.dialog[id="'+d+'"]');!e.length||f||g.length||e.eq(0).trigger("click")})}(this,window.jQuery),function(a,b){function c(){var a=this;this.registry=[],b(window.document).bind("focusin.focus-registry",function(b){a.check(b)})}var d=a.componentNamespace.Dialog,e=a.document,f="dialog";b.fn[f]=function(){return this.each(function(){var c=b(this);if(!c.data("dialog")){var f,g,h,i,j=new d(this);c.addClass(d.classes.content).bind(d.events.open,f=function(){j.open()}).bind(d.events.close,g=function(){j.close()}).bind("click",h=function(a){b(a.target).closest(d.selectors.close).length&&(a.preventDefault(),j.close())}),j.$background.bind("click",i=function(){j.close()});var k;d.useHash&&b(a).bind("hashchange",k=function(){var b=a.location.hash.split("#").pop();b===j.hash?j.nohistory||j.open():j.close()});var l,m,n;b(e).bind("click",l=function(a){var e,f;if(f=b(a.target).closest("a"),!j.isOpen&&f.length&&f.attr("href")){var g=f.attr("href").replace(/^#/,"");try{e=b("[id='"+g+"'],\t[id='"+encodeURIComponent(g)+"']")}catch(h){return}e.length&&e.is(c)&&(a.preventDefault(),e.trigger(d.events.open))}}),b(e).bind("keyup",m=function(a){27===a.which&&j.close()}),j._checkInteractivity();var o;b(window).bind("resize",n=function(){o&&clearTimeout(o),o=setTimeout(function(){j._checkInteractivity.call(j)},150)}),c.bind("destroy",function(){b(a).unbind("hashchange",k),c.unbind(d.events.open,f).unbind(d.events.close,g).unbind("click",h),j.$background.unbind("click",i),b(e).unbind("click",l),b(e).unbind("keyup",m),b(window).unbind("resize",n)}),k(),window.focusRegistry.register(j)}})},b(a.document).bind("enhance",function(c){var d=c.target===a.document?"":c.target;b("."+f,c.target).add(d).filter("."+f)[f]()}),c.prototype.register=function(a){if(!a.checkFocus)throw new Error("Obj must implement `checkFocus`");if(!a.stealFocus)throw new Error("Obj must implement `stealFocus`");this.registry.push(a)},c.prototype.unregister=function(a){for(var b=[],c=0;c<this.registry.length;c++)this.registry[c]!==a&&b.push(this.registry[c]);this.registry=b},c.prototype.check=function(a){for(var b=[],c=0;c<this.registry.length;c++)this.registry[c].checkFocus(a)&&b.push(this.registry[c]);if(b.length>1)throw new Error("Two components are attempting to steal focus.");b[0]&&(a.preventDefault(),setTimeout(function(){b[0].stealFocus(a)}))},window.componentNamespace.FocusRegistry=c,window.focusRegistry=new c}(this,window.jQuery);