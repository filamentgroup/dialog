window.jQuery=window.jQuery||window.shoestring,function(a,b){a.componentNamespace=a.componentNamespace||a;var c,d,e="dialog",f=a.document,g=f.documentElement,h=f.body,i=b(g),j=a.componentNamespace.Dialog=function(d){if(this.$el=b(d),this.$el.data(e))return this.$el.data(e);this.$el.data(e,this),this.$background=this.$el.is("[data-"+e+"-nobg]")?b([]):b(f.createElement("div")).addClass(c.bkgd).appendTo("body"),this.initialLocationHash=a.location.hash,this.nohistory="false"===this.$el.attr("data-dialog-history")||!j.history,this.hash=this.$el.attr("id")+"-dialog",this.hash+=this.nohistory?"-"+Date.now().toString():"",this.isOpen=!1,this.isTransparentBackground=this.$el.is("[data-transbg]"),this._addA11yAttrs()};j.history=!0,j.events=d={open:e+"-open",opened:e+"-opened",close:e+"-close",closed:e+"-closed"},j.classes=c={open:e+"-open",opened:e+"-opened",content:e+"-content",close:e+"-close",closed:e+"-closed",bkgd:e+"-background",bkgdOpen:e+"-background-open",bkgdTrans:e+"-background-trans"},j.selectors={close:"."+j.classes.close+", [data-close], [data-dialog-close]"},j.prototype.destroy=function(){window.focusRegistry.unregister(this),this.$el.data()[e]=void 0,this.$background.remove()},j.prototype.checkFocus=function(a){var c=b(a.target);return this.isOpen&&!c.closest(this.$el[0]).length&&this.isLastDialog()&&!this._isNonInteractive()},j.prototype.stealFocus=function(){this.$el[0].focus()},j.prototype._addA11yAttrs=function(){this.$el.attr("role","dialog"),this.$el.attr("tabindex","0")},j.prototype._removeA11yAttrs=function(){this.$el.removeAttr("role"),this.$el.removeAttr("tabindex")},j.prototype._isNonInteractive=function(){var a,b=window.getComputedStyle(this.$el[0],null),c=this.$el.find(j.selectors.close)[0];c&&(a=window.getComputedStyle(c,null));var d=window.getComputedStyle(this.$background[0],null);return"none"!==b.getPropertyValue("display")&&"hidden"!==b.getPropertyValue("visibility")&&(!a||"none"===a.getPropertyValue("display"))&&"none"===d.getPropertyValue("display")},j.prototype._checkInteractivity=function(){this._isNonInteractive()?this._removeA11yAttrs():this._addA11yAttrs()},j.prototype.open=function(){if(!this.isOpen){this.$background.length&&(this.$background[0].style.height=Math.max(g.scrollHeight,g.clientHeight)+"px"),this.$el.addClass(c.open),this.$background.addClass(c.bkgdOpen),this.$background.attr("id",this.$el.attr("id")+"-background"),this._setBackgroundTransparency(),this.scroll="pageYOffset"in a?a.pageYOffset:g.scrollY||g.scrollTop||h&&h.scrollY||0,this.$el[0].style.top=this.scroll+"px",i.addClass(c.open),this.isOpen=!0;a.location.hash.replace(/^#/,"").indexOf("-dialog")>-1&&!this.isLastDialog()?a.location.hash+="#"+this.hash:this.isLastDialog()||(a.location.hash=this.hash),f.activeElement&&(this.focused=f.activeElement),this.$el[0].focus(),this.$el.trigger(d.opened)}},j.prototype.lastHash=function(){return a.location.hash.split("#").pop()},j.prototype.isLastDialog=function(){return this.lastHash()===this.hash},j.prototype._setBackgroundTransparency=function(){this.isTransparentBackground&&this.$background.addClass(c.bkgdTrans)},j.prototype.close=function(){if(this.isOpen)if(window.location.hash.split("#").pop()!==this.hash)this.$el.removeClass(c.open),this.$background.removeClass(c.bkgdOpen),i.removeClass(c.open),this.isOpen=!1,this.focused&&!this.isLastDialog()&&this.focused.focus(),this.isLastDialog()&&a.scrollTo(0,this.scroll),this.$el.trigger(d.closed);else{var b=window.location.hash.split("#")[1],e=this.initialLocationHash.split("#")[1];if(b&&e&&e!==b)window.history.back();else{var f=this.hash.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");window.location.hash=window.location.hash.replace(new RegExp("#"+f+"$"),"")}}}}(this,window.jQuery),function(a,b){b(a.document).bind("click",function(c){function d(c){function d(){n.trigger("dialog-open")}var f,h=e.attr("href"),i=e.attr("data-dialog-addclass")||"",j=e.attr("data-dialog-labeledby")||"",k=e.attr("data-dialog-label")||"",l="false"===e.attr("data-dialog-history")||!a.componentNamespace.Dialog.history;h&&(f=encodeURIComponent(h));var m=b("[id='"+f+"']");if(m.length)return void m.html("").append(c).dialog().trigger("enhance");e.attr("href","#"+f).removeAttr("data-dialog-link");var n=b("<div class='dialog "+i+"' id='"+f+"' "+(l?" data-dialog-history='false'":"")+(k?" aria-label='"+k+"'":"")+(j?" aria-labelledby='"+j+"'":"")+"></div>").append(c).appendTo("body").dialog(),o=n.data("dialog");o&&!o.focused&&(o.focused=e[0]),g?n.find("iframe").one("load",d):d(),n.trigger("enhance")}var e=b(c.target).closest("a"),f=e.is("[data-dialog-link]"),g=e.is("[data-dialog-iframe]");if(f){var h=e.attr("href");e.is("[data-dialog-iframe]")?d("<iframe src='"+h+"' class='dialog-iframe'></iframe>"):b.get(h,d),c.preventDefault()}}),b(a).bind("hashchange load",function(){var c=a.location.hash.split("#").pop(),d=c.replace(/-dialog$/,""),e=b('a[href="'+decodeURIComponent(d)+'"][data-dialog-link], a[href="'+d+'"][data-dialog-link]'),f="false"===e.attr("data-dialog-history")||!a.componentNamespace.Dialog.history,g=b('.dialog[id="'+d+'"]');!e.length||f||g.length||e.eq(0).trigger("click")})}(this,window.jQuery),function(a,b){function c(){var a=this;this.registry=[],b(window.document).bind("focusin.focus-registry",function(b){a.check(b)})}var d=a.componentNamespace.Dialog,e=a.document,f="dialog";b.fn[f]=function(){return this.each(function(){var c=b(this);if(!c.data("dialog")){var f=new d(this);c.addClass(d.classes.content).bind(d.events.open,function(){f.open()}).bind(d.events.close,function(){f.close()}).bind("click",function(a){b(a.target).closest(d.selectors.close).length&&(a.preventDefault(),f.close())}),f.$background.bind("click",function(){f.close()});var g;b(a).bind("hashchange",g=function(){a.location.hash.split("#").pop()===f.hash?f.nohistory||f.open():f.close()}),g(),b(e).bind("click",function(a){var e,g;if(g=b(a.target).closest("a"),!f.isOpen&&g.length&&g.attr("href")){var h=g.attr("href").replace(/^#/,"");try{e=b("[id='"+h+"'],\t[id='"+encodeURIComponent(h)+"']")}catch(i){return}e.length&&e.is(c)&&(e.trigger(d.events.open),a.preventDefault())}}),b(e).bind("keyup",function(a){27===a.which&&f.close()}),f._checkInteractivity();var h;b(window).bind("resize",function(){h&&clearTimeout(h),h=setTimeout(function(){f._checkInteractivity.call(f)},150)}),window.focusRegistry.register(f)}})},b(a.document).bind("enhance",function(c){var d=c.target===a.document?"":c.target;b("."+f,c.target).add(d).filter("."+f)[f]()}),c.prototype.register=function(a){if(!a.checkFocus)throw new Error("Obj must implement `checkFocus`");if(!a.stealFocus)throw new Error("Obj must implement `stealFocus`");this.registry.push(a)},c.prototype.unregister=function(a){for(var b=[],c=0;c<this.registry.length;c++)this.registry[c]!==a&&b.push(this.registry[c]);this.registry=b},c.prototype.check=function(a){for(var b=[],c=0;c<this.registry.length;c++)this.registry[c].checkFocus(a)&&b.push(this.registry[c]);if(b.length>1)throw new Error("Two components are attempting to steal focus.");b[0]&&(a.preventDefault(),setTimeout(function(){b[0].stealFocus(a)}))},window.componentNamespace.FocusRegistry=c,window.focusRegistry=new c}(this,window.jQuery);