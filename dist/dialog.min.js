window.jQuery=window.jQuery||window.shoestring,function(a,b){a.componentNamespace=a.componentNamespace||a;var c,d,e="dialog",f=a.document,g=f.documentElement,h=f.body,i=b(g),j=a.componentNamespace.Dialog=function(d){return this.$el=b(d),this.$el.data(e)?this.$el.data(e):(this.$el.data(e,this),this.$background=this.$el.is("[data-nobg]")?b([]):b(f.createElement("div")).addClass(c.bkgd).appendTo("body"),this.initialLocationHash=a.location.hash,this.nohistory=this.$el.is("[data-dialog-nohistory]"),this.hash=this.$el.attr("id")+"-dialog",this.hash+=this.nohistory?"-"+Date.now().toString():"",this.isOpen=!1,void(this.isTransparentBackground=this.$el.is("[data-transbg]")))};j.events=d={open:e+"-open",opened:e+"-opened",close:e+"-close",closed:e+"-closed"},j.classes=c={open:e+"-open",opened:e+"-opened",content:e+"-content",close:e+"-close",closed:e+"-closed",bkgd:e+"-background",bkgdOpen:e+"-background-open",bkgdTrans:e+"-background-trans"},j.selectors={close:"."+j.classes.close+", [data-close], [data-dialog-close]"},j.prototype.destroy=function(){this.$el.data()[e]=void 0,this.$background.remove()},j.prototype.open=function(){if(!this.isOpen){this.$background.length&&(this.$background[0].style.height=Math.max(g.scrollHeight,g.clientHeight)+"px"),this.$el.addClass(c.open),this.$background.addClass(c.bkgdOpen),this.$background.attr("id",this.$el.attr("id")+"-background"),this._setBackgroundTransparency(),this.scroll="pageYOffset"in a?a.pageYOffset:g.scrollY||g.scrollTop||h&&h.scrollY||0,this.$el[0].style.top=this.scroll+"px",i.addClass(c.open),this.isOpen=!0;var b=a.location.hash.replace(/^#/,""),e=a.location.hash.split("#").pop();b.indexOf("-dialog")>-1&&e!==this.hash?a.location.hash+="#"+this.hash:e!==this.hash&&(a.location.hash=this.hash),f.activeElement&&(this.focused=f.activeElement),this.$el[0].focus(),this.$el.trigger(d.opened)}},j.prototype._setBackgroundTransparency=function(){this.isTransparentBackground&&this.$background.addClass(c.bkgdTrans)},j.prototype.close=function(){if(this.isOpen)if(window.location.hash.split("#").pop()!==this.hash)this.$el.removeClass(c.open),this.$background.removeClass(c.bkgdOpen),i.removeClass(c.open),this.focused&&this.focused.focus(),a.scrollTo(0,this.scroll),this.isOpen=!1,this.$el.trigger(d.closed);else{var b=window.location.hash.split("#")[1],e=this.initialLocationHash.split("#")[1];if(b&&e&&e!==b)window.history.back();else{var f=this.hash.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");window.location.hash=window.location.hash.replace(new RegExp("#"+f+"$"),"")}}}}(this,window.jQuery),function(a,b){var c=a.componentNamespace.Dialog,d=a.document,e="dialog";b.fn[e]=function(){return this.each(function(){var e=b(this),f=new c(this);e.addClass(c.classes.content).attr("role","dialog").attr("tabindex",0).bind(c.events.open,function(){f.open()}).bind(c.events.close,function(){f.close()}).bind("click",function(a){b(a.target).closest(c.selectors.close).length&&(a.preventDefault(),f.close())}),f.$background.bind("click",function(){f.close()});var g;b(a).bind("hashchange",g=function(){var b=a.location.hash.split("#").pop();b===f.hash?f.nohistory||f.open():f.close()}),g(),b(d).bind("click",function(a){var d,g;if(g=b(a.target).closest("a"),!f.isOpen&&g.length&&g.attr("href")){var h=g.attr("href").replace(/^#/,"");try{d=b("[id='"+h+"']")}catch(i){return}d.length&&d.is(e)&&(d.trigger(c.events.open),a.preventDefault())}}),b(d).bind("keyup",function(a){27===a.which&&f.close()})})},b(a.document).bind("enhance",function(c){var d=c.target===a.document?"":c.target;b("."+e,c.target).add(d).filter("."+e)[e]()})}(this,window.jQuery);